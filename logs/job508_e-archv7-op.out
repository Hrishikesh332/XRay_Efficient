=== Job 508 started at Fri Nov 14 22:34:06 UTC 2025 on gpu-workers-0 ===
=== Running: flwr run . cluster-gpu ===
Loading project configuration... 
Success
[92mINFO [0m:      Device: AMD Instinct MI300X VF
[92mINFO [0m:      W&B disabled (credentials not provided). Set WANDB_API_KEY, WANDB_ENTITY, and WANDB_PROJECT to enable.
Downloading: "https://download.pytorch.org/models/efficientnet_b0_rwightman-7f5810bc.pth" to /tmp/job-508/xdg-cache/torch/hub/checkpoints/efficientnet_b0_rwightman-7f5810bc.pth
  0%|          | 0.00/20.5M [00:00<?, ?B/s] 28%|â–ˆâ–ˆâ–Š       | 5.62M/20.5M [00:00<00:00, 58.1MB/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 11.5M/20.5M [00:00<00:00, 59.6MB/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 20.5M/20.5M [00:00<00:00, 94.2MB/s]
[92mINFO [0m:      Starting HackathonFedAvg strategy:
[92mINFO [0m:      	â”œâ”€â”€ Number of rounds: 100
[92mINFO [0m:      	â”œâ”€â”€ ArrayRecord (15.49 MB)
[92mINFO [0m:      	â”œâ”€â”€ ConfigRecord (train): {'lr': 0.05}
[92mINFO [0m:      	â”œâ”€â”€ ConfigRecord (evaluate): (empty!)
[92mINFO [0m:      	â”œâ”€â”€> Sampling:
[92mINFO [0m:      	â”‚	â”œâ”€â”€Fraction: train (1.00) | evaluate ( 1.00)
[92mINFO [0m:      	â”‚	â”œâ”€â”€Minimum nodes: train (2) | evaluate (2)
[92mINFO [0m:      	â”‚	â””â”€â”€Minimum available nodes: 2
[92mINFO [0m:      	â””â”€â”€> Keys in records:
[92mINFO [0m:      		â”œâ”€â”€ Weighted by: 'num-examples'
[92mINFO [0m:      		â”œâ”€â”€ ArrayRecord key: 'arrays'
[92mINFO [0m:      		â””â”€â”€ ConfigRecord key: 'config'
[92mINFO [0m:      
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[36m(ClientAppActor pid=2529902)[0m /usr/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=2529902) is multi-threaded, use of fork() may lead to deadlocks in the child.
[36m(ClientAppActor pid=2529902)[0m   self.pid = os.fork()
[36m(ClientAppActor pid=2529902)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.pin_memory() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:46.)
[36m(ClientAppActor pid=2529902)[0m   return data.pin_memory(device)
[36m(ClientAppActor pid=2529902)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.is_pinned() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:31.)
[36m(ClientAppActor pid=2529902)[0m   return data.pin_memory(device)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.6619688947348413}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.5040
[92mINFO [0m:          eval_loss   : 0.9651
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.3787
[92mINFO [0m:          f1          : 0.5493
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.4996
[92mINFO [0m:          eval_loss   : 0.8136
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.5183
[92mINFO [0m:          f1          : 0.6828
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.5003
[92mINFO [0m:          eval_loss   : 0.8643
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.4709
[92mINFO [0m:          f1          : 0.6402
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.5012
[92mINFO [0m:        sensitivity : 1.0000
[92mINFO [0m:        specificity : 0.0000
[92mINFO [0m:        precision   : 0.4588
[92mINFO [0m:        f1          : 0.6290
[92mINFO [0m:      âœ“ New best model! Round 1, AUROC: 0.5012
[92mINFO [0m:        Model saved to models/job508_e-archv7-op_round1_auroc5011.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.5011642649969487, 'sensitivity': 1.0, 'specificity': 0.0, 'precision': 0.4587545126353791, 'f1': 0.6289673946668316}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.19857425375781276}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.4937
[92mINFO [0m:          eval_loss   : 0.6672
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.4950
[92mINFO [0m:          eval_loss   : 0.7114
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.5004
[92mINFO [0m:          eval_loss   : 0.6966
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.4971
[92mINFO [0m:        sensitivity : 0.0000
[92mINFO [0m:        specificity : 1.0000
[92mINFO [0m:        precision   : 0.0000
[92mINFO [0m:        f1          : 0.0000
[92mINFO [0m:        Model not saved (AUROC 0.4971 â‰¤ best 0.5012)
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.49713231263149443, 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'f1': 0.0}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.32390303928825115}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.4688
[92mINFO [0m:          eval_loss   : 0.8373
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.4845
[92mINFO [0m:          eval_loss   : 0.6942
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.4677
[92mINFO [0m:          eval_loss   : 0.7893
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.4730
[92mINFO [0m:        sensitivity : 0.0000
[92mINFO [0m:        specificity : 1.0000
[92mINFO [0m:        precision   : 0.0000
[92mINFO [0m:        f1          : 0.0000
[92mINFO [0m:        Model not saved (AUROC 0.4730 â‰¤ best 0.5012)
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.47302448194390323, 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'f1': 0.0}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.1401795572648344}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.6864
[92mINFO [0m:          eval_loss   : 0.6992
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7182
[92mINFO [0m:          eval_loss   : 0.6715
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7105
[92mINFO [0m:          eval_loss   : 0.6897
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7115
[92mINFO [0m:        sensitivity : 0.0000
[92mINFO [0m:        specificity : 1.0000
[92mINFO [0m:        precision   : 0.0000
[92mINFO [0m:        f1          : 0.0000
[92mINFO [0m:      âœ“ New best model! Round 4, AUROC: 0.7115
[92mINFO [0m:        Model saved to models/job508_e-archv7-op_round4_auroc7115.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7115496399914825, 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'f1': 0.0}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.19691316298076716}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.6930
[92mINFO [0m:          eval_loss   : 0.6672
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.6784
[92mINFO [0m:          eval_loss   : 0.7022
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.6967
[92mINFO [0m:          eval_loss   : 0.6903
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.6966
[92mINFO [0m:        sensitivity : 0.0000
[92mINFO [0m:        specificity : 1.0000
[92mINFO [0m:        precision   : 0.0000
[92mINFO [0m:        f1          : 0.0000
[92mINFO [0m:        Model not saved (AUROC 0.6966 â‰¤ best 0.7115)
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.6966010220009342, 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'f1': 0.0}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.21382297909972636}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7086
[92mINFO [0m:          eval_loss   : 0.7018
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7517
[92mINFO [0m:          eval_loss   : 0.6536
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7338
[92mINFO [0m:          eval_loss   : 0.6849
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7363
[92mINFO [0m:        sensitivity : 0.0000
[92mINFO [0m:        specificity : 1.0000
[92mINFO [0m:        precision   : 0.0000
[92mINFO [0m:        f1          : 0.0000
[92mINFO [0m:      âœ“ New best model! Round 6, AUROC: 0.7363
[92mINFO [0m:        Model saved to models/job508_e-archv7-op_round6_auroc7362.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7362930760415948, 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'f1': 0.0}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.13638938337192932}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7143
[92mINFO [0m:          eval_loss   : 0.6601
[92mINFO [0m:          sensitivity : 0.7852
[92mINFO [0m:          specificity : 0.5087
[92mINFO [0m:          precision   : 0.6323
[92mINFO [0m:          f1          : 0.7005
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7667
[92mINFO [0m:          eval_loss   : 0.6544
[92mINFO [0m:          sensitivity : 0.7175
[92mINFO [0m:          specificity : 0.6736
[92mINFO [0m:          precision   : 0.5726
[92mINFO [0m:          f1          : 0.6369
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7412
[92mINFO [0m:          eval_loss   : 0.6597
[92mINFO [0m:          sensitivity : 0.8344
[92mINFO [0m:          specificity : 0.4874
[92mINFO [0m:          precision   : 0.5916
[92mINFO [0m:          f1          : 0.6923
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7448
[92mINFO [0m:        sensitivity : 0.7958
[92mINFO [0m:        specificity : 0.5473
[92mINFO [0m:        precision   : 0.5984
[92mINFO [0m:        f1          : 0.6831
[92mINFO [0m:      âœ“ New best model! Round 7, AUROC: 0.7448
[92mINFO [0m:        Model saved to models/job508_e-archv7-op_round7_auroc7447.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7447619475027041, 'sensitivity': 0.7957898878614991, 'specificity': 0.5472736368184092, 'precision': 0.5983727810650887, 'f1': 0.6831039432576205}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.19282608340065782}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7167
[92mINFO [0m:          eval_loss   : 0.6643
[92mINFO [0m:          sensitivity : 0.9293
[92mINFO [0m:          specificity : 0.2304
[92mINFO [0m:          precision   : 0.5651
[92mINFO [0m:          f1          : 0.7028
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7675
[92mINFO [0m:          eval_loss   : 0.6765
[92mINFO [0m:          sensitivity : 0.9003
[92mINFO [0m:          specificity : 0.3483
[92mINFO [0m:          precision   : 0.4571
[92mINFO [0m:          f1          : 0.6063
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7415
[92mINFO [0m:          eval_loss   : 0.6714
[92mINFO [0m:          sensitivity : 0.9358
[92mINFO [0m:          specificity : 0.2330
[92mINFO [0m:          precision   : 0.5206
[92mINFO [0m:          f1          : 0.6690
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7460
[92mINFO [0m:        sensitivity : 0.9264
[92mINFO [0m:        specificity : 0.2666
[92mINFO [0m:        precision   : 0.5171
[92mINFO [0m:        f1          : 0.6637
[92mINFO [0m:      âœ“ New best model! Round 8, AUROC: 0.7460
[92mINFO [0m:        Model saved to models/job508_e-archv7-op_round8_auroc7460.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7460247108274447, 'sensitivity': 0.9264214046822743, 'specificity': 0.2666333166583292, 'precision': 0.5170747776435709, 'f1': 0.663706835799859}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 9/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[2025-11-14T22:54:09] error: *** JOB 508 ON gpu-workers-0 CANCELLED AT 2025-11-14T22:54:09 DUE TO TIME LIMIT ***
=== Copying best model ===
  job508_e-archv7-op_round8_auroc7460.pt
=== Job 508 finished with exit code 0 ===
