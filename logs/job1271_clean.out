=== Job 1271 started at Sat Nov 15 11:01:38 UTC 2025 on gpu-workers-1 ===
=== Running: flwr run . cluster-gpu ===
Loading project configuration... 
Success
[92mINFO [0m:      Device: AMD Instinct MI300X VF
[92mINFO [0m:      W&B disabled (credentials not provided). Set WANDB_API_KEY, WANDB_ENTITY, and WANDB_PROJECT to enable.
Downloading: "https://download.pytorch.org/models/efficientnet_b0_rwightman-7f5810bc.pth" to /tmp/job-1271/xdg-cache/torch/hub/checkpoints/efficientnet_b0_rwightman-7f5810bc.pth
  0%|          | 0.00/20.5M [00:00<?, ?B/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 20.5M/20.5M [00:00<00:00, 241MB/s]
[92mINFO [0m:      Starting HackathonFedAvg strategy:
[92mINFO [0m:      	â”œâ”€â”€ Number of rounds: 100
[92mINFO [0m:      	â”œâ”€â”€ ArrayRecord (15.49 MB)
[92mINFO [0m:      	â”œâ”€â”€ ConfigRecord (train): {'lr': 0.03}
[92mINFO [0m:      	â”œâ”€â”€ ConfigRecord (evaluate): (empty!)
[92mINFO [0m:      	â”œâ”€â”€> Sampling:
[92mINFO [0m:      	â”‚	â”œâ”€â”€Fraction: train (1.00) | evaluate ( 1.00)
[92mINFO [0m:      	â”‚	â”œâ”€â”€Minimum nodes: train (2) | evaluate (2)
[92mINFO [0m:      	â”‚	â””â”€â”€Minimum available nodes: 2
[92mINFO [0m:      	â””â”€â”€> Keys in records:
[92mINFO [0m:      		â”œâ”€â”€ Weighted by: 'num-examples'
[92mINFO [0m:      		â”œâ”€â”€ ArrayRecord key: 'arrays'
[92mINFO [0m:      		â””â”€â”€ ConfigRecord key: 'config'
[92mINFO [0m:      
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[36m(ClientAppActor pid=3032507)[0m /usr/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=3032507) is multi-threaded, use of fork() may lead to deadlocks in the child.
[36m(ClientAppActor pid=3032507)[0m   self.pid = os.fork()
[36m(ClientAppActor pid=3032507)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.pin_memory() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:46.)
[36m(ClientAppActor pid=3032507)[0m   return data.pin_memory(device)
[36m(ClientAppActor pid=3032507)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.is_pinned() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:31.)
[36m(ClientAppActor pid=3032507)[0m   return data.pin_memory(device)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.5015114221987537}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.6355
[92mINFO [0m:          eval_loss   : 0.7264
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.5183
[92mINFO [0m:          f1          : 0.6828
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.6414
[92mINFO [0m:          eval_loss   : 0.8106
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.3787
[92mINFO [0m:          f1          : 0.5493
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.6807
[92mINFO [0m:          eval_loss   : 0.7544
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.4709
[92mINFO [0m:          f1          : 0.6402
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.6610
[92mINFO [0m:        sensitivity : 1.0000
[92mINFO [0m:        specificity : 0.0000
[92mINFO [0m:        precision   : 0.4588
[92mINFO [0m:        f1          : 0.6290
[92mINFO [0m:      âœ“ New best model! Round 1, AUROC: 0.6610
[92mINFO [0m:        Model saved to models/job1271_clean_round1_auroc6609.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.6609822879831285, 'sensitivity': 1.0, 'specificity': 0.0, 'precision': 0.4587545126353791, 'f1': 0.6289673946668316}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.19983851491669308}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7422
[92mINFO [0m:          eval_loss   : 0.6840
[92mINFO [0m:          sensitivity : 0.0693
[92mINFO [0m:          specificity : 0.9921
[92mINFO [0m:          precision   : 0.8427
[92mINFO [0m:          f1          : 0.1280
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7033
[92mINFO [0m:          eval_loss   : 0.6906
[92mINFO [0m:          sensitivity : 0.0339
[92mINFO [0m:          specificity : 0.9886
[92mINFO [0m:          precision   : 0.7619
[92mINFO [0m:          f1          : 0.0650
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7276
[92mINFO [0m:          eval_loss   : 0.6882
[92mINFO [0m:          sensitivity : 0.0936
[92mINFO [0m:          specificity : 0.9745
[92mINFO [0m:          precision   : 0.7658
[92mINFO [0m:          f1          : 0.1668
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7299
[92mINFO [0m:        sensitivity : 0.0718
[92mINFO [0m:        specificity : 0.9828
[92mINFO [0m:        precision   : 0.7799
[92mINFO [0m:        f1          : 0.1315
[92mINFO [0m:      âœ“ New best model! Round 2, AUROC: 0.7299
[92mINFO [0m:        Model saved to models/job1271_clean_round2_auroc7298.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7298836151632115, 'sensitivity': 0.07180798740901043, 'specificity': 0.9828247457061864, 'precision': 0.7799145299145299, 'f1': 0.13150783642586922}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.19931450943502793}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7098
[92mINFO [0m:          eval_loss   : 0.6865
[92mINFO [0m:          sensitivity : 0.9413
[92mINFO [0m:          specificity : 0.1856
[92mINFO [0m:          precision   : 0.5543
[92mINFO [0m:          f1          : 0.6977
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7602
[92mINFO [0m:          eval_loss   : 0.6896
[92mINFO [0m:          sensitivity : 0.9261
[92mINFO [0m:          specificity : 0.2853
[92mINFO [0m:          precision   : 0.4413
[92mINFO [0m:          f1          : 0.5977
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7473
[92mINFO [0m:          eval_loss   : 0.6874
[92mINFO [0m:          sensitivity : 0.9563
[92mINFO [0m:          specificity : 0.1790
[92mINFO [0m:          precision   : 0.5090
[92mINFO [0m:          f1          : 0.6643
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7455
[92mINFO [0m:        sensitivity : 0.9457
[92mINFO [0m:        specificity : 0.2119
[92mINFO [0m:        precision   : 0.5042
[92mINFO [0m:        f1          : 0.6578
[92mINFO [0m:      âœ“ New best model! Round 3, AUROC: 0.7455
[92mINFO [0m:        Model saved to models/job1271_clean_round3_auroc7455.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.74553043129211, 'sensitivity': 0.9457013574660633, 'specificity': 0.21193930298482574, 'precision': 0.5042484002937165, 'f1': 0.6577723043240284}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.18955963000028242}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7171
[92mINFO [0m:          eval_loss   : 0.6770
[92mINFO [0m:          sensitivity : 0.9993
[92mINFO [0m:          specificity : 0.0023
[92mINFO [0m:          precision   : 0.5187
[92mINFO [0m:          f1          : 0.6829
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7706
[92mINFO [0m:          eval_loss   : 0.7090
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0051
[92mINFO [0m:          precision   : 0.3799
[92mINFO [0m:          f1          : 0.5506
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7488
[92mINFO [0m:          eval_loss   : 0.6903
[92mINFO [0m:          sensitivity : 0.9996
[92mINFO [0m:          specificity : 0.0024
[92mINFO [0m:          precision   : 0.4714
[92mINFO [0m:          f1          : 0.6406
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7502
[92mINFO [0m:        sensitivity : 0.9996
[92mINFO [0m:        specificity : 0.0032
[92mINFO [0m:        precision   : 0.4594
[92mINFO [0m:        f1          : 0.6295
[92mINFO [0m:      âœ“ New best model! Round 4, AUROC: 0.7502
[92mINFO [0m:        Model saved to models/job1271_clean_round4_auroc7502.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.750215228277789, 'sensitivity': 0.999606531575841, 'specificity': 0.003168250792062698, 'precision': 0.45944479609367933, 'f1': 0.6295378515673399}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.1774659274667567}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7780
[92mINFO [0m:          eval_loss   : 0.6716
[92mINFO [0m:          sensitivity : 0.9151
[92mINFO [0m:          specificity : 0.3647
[92mINFO [0m:          precision   : 0.4675
[92mINFO [0m:          f1          : 0.6188
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7256
[92mINFO [0m:          eval_loss   : 0.6568
[92mINFO [0m:          sensitivity : 0.9435
[92mINFO [0m:          specificity : 0.2411
[92mINFO [0m:          precision   : 0.5722
[92mINFO [0m:          f1          : 0.7124
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7549
[92mINFO [0m:          eval_loss   : 0.6647
[92mINFO [0m:          sensitivity : 0.9482
[92mINFO [0m:          specificity : 0.2320
[92mINFO [0m:          precision   : 0.5235
[92mINFO [0m:          f1          : 0.6746
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7574
[92mINFO [0m:        sensitivity : 0.9398
[92mINFO [0m:        specificity : 0.2733
[92mINFO [0m:        precision   : 0.5229
[92mINFO [0m:        f1          : 0.6720
[92mINFO [0m:      âœ“ New best model! Round 5, AUROC: 0.7574
[92mINFO [0m:        Model saved to models/job1271_clean_round5_auroc7574.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7574010134452758, 'sensitivity': 0.939799331103679, 'specificity': 0.2733033183258296, 'precision': 0.5229337712096332, 'f1': 0.6719651146434098}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.17838515950658076}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7270
[92mINFO [0m:          eval_loss   : 0.6419
[92mINFO [0m:          sensitivity : 0.8403
[92mINFO [0m:          specificity : 0.4494
[92mINFO [0m:          precision   : 0.6215
[92mINFO [0m:          f1          : 0.7145
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7818
[92mINFO [0m:          eval_loss   : 0.6408
[92mINFO [0m:          sensitivity : 0.7886
[92mINFO [0m:          specificity : 0.6246
[92mINFO [0m:          precision   : 0.5615
[92mINFO [0m:          f1          : 0.6559
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7553
[92mINFO [0m:          eval_loss   : 0.6456
[92mINFO [0m:          sensitivity : 0.8735
[92mINFO [0m:          specificity : 0.4423
[92mINFO [0m:          precision   : 0.5823
[92mINFO [0m:          f1          : 0.6987
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7588
[92mINFO [0m:        sensitivity : 0.8462
[92mINFO [0m:        specificity : 0.4979
[92mINFO [0m:        precision   : 0.5882
[92mINFO [0m:        f1          : 0.6940
[92mINFO [0m:      âœ“ New best model! Round 6, AUROC: 0.7588
[92mINFO [0m:        Model saved to models/job1271_clean_round6_auroc7588.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7588243593893478, 'sensitivity': 0.8461538461538461, 'specificity': 0.49791562447890614, 'precision': 0.5882111597374179, 'f1': 0.6939895118999596}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.1807807140064455}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7280
[92mINFO [0m:          eval_loss   : 0.6396
[92mINFO [0m:          sensitivity : 0.7661
[92mINFO [0m:          specificity : 0.5650
[92mINFO [0m:          precision   : 0.6546
[92mINFO [0m:          f1          : 0.7060
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7819
[92mINFO [0m:          eval_loss   : 0.6267
[92mINFO [0m:          sensitivity : 0.6916
[92mINFO [0m:          specificity : 0.7248
[92mINFO [0m:          precision   : 0.6050
[92mINFO [0m:          f1          : 0.6454
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7569
[92mINFO [0m:          eval_loss   : 0.6374
[92mINFO [0m:          sensitivity : 0.8155
[92mINFO [0m:          specificity : 0.5663
[92mINFO [0m:          precision   : 0.6259
[92mINFO [0m:          f1          : 0.7082
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7600
[92mINFO [0m:        sensitivity : 0.7753
[92mINFO [0m:        specificity : 0.6130
[92mINFO [0m:        precision   : 0.6294
[92mINFO [0m:        f1          : 0.6948
[92mINFO [0m:      âœ“ New best model! Round 7, AUROC: 0.7600
[92mINFO [0m:        Model saved to models/job1271_clean_round7_auroc7599.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7599979739361452, 'sensitivity': 0.7753295298052332, 'specificity': 0.6129731532432883, 'precision': 0.6293516448419035, 'f1': 0.6947553988541207}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[2025-11-15T11:21:49] error: *** JOB 1271 ON gpu-workers-1 CANCELLED AT 2025-11-15T11:21:49 DUE TO TIME LIMIT ***
=== Copying best model ===
  job1271_clean_round7_auroc7599.pt
=== Job 1271 finished with exit code 0 ===
