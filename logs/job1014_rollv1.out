=== Job 1014 started at Sat Nov 15 08:01:05 UTC 2025 on gpu-workers-0 ===
=== Running: flwr run . cluster-gpu ===
Loading project configuration... 
Success
[92mINFO [0m:      Device: AMD Instinct MI300X VF
[92mINFO [0m:      W&B disabled (credentials not provided). Set WANDB_API_KEY, WANDB_ENTITY, and WANDB_PROJECT to enable.
Downloading: "https://download.pytorch.org/models/efficientnet_b0_rwightman-7f5810bc.pth" to /tmp/job-1014/xdg-cache/torch/hub/checkpoints/efficientnet_b0_rwightman-7f5810bc.pth
  0%|          | 0.00/20.5M [00:00<?, ?B/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 20.5M/20.5M [00:00<00:00, 590MB/s]
[92mINFO [0m:      Starting HackathonFedAvg strategy:
[92mINFO [0m:      	â”œâ”€â”€ Number of rounds: 100
[92mINFO [0m:      	â”œâ”€â”€ ArrayRecord (15.49 MB)
[92mINFO [0m:      	â”œâ”€â”€ ConfigRecord (train): {'lr': 0.05}
[92mINFO [0m:      	â”œâ”€â”€ ConfigRecord (evaluate): (empty!)
[92mINFO [0m:      	â”œâ”€â”€> Sampling:
[92mINFO [0m:      	â”‚	â”œâ”€â”€Fraction: train (1.00) | evaluate ( 1.00)
[92mINFO [0m:      	â”‚	â”œâ”€â”€Minimum nodes: train (2) | evaluate (2)
[92mINFO [0m:      	â”‚	â””â”€â”€Minimum available nodes: 2
[92mINFO [0m:      	â””â”€â”€> Keys in records:
[92mINFO [0m:      		â”œâ”€â”€ Weighted by: 'num-examples'
[92mINFO [0m:      		â”œâ”€â”€ ArrayRecord key: 'arrays'
[92mINFO [0m:      		â””â”€â”€ ConfigRecord key: 'config'
[92mINFO [0m:      
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
2025-11-15 08:01:16,763	WARNING services.py:2009 -- WARNING: The object store is using /tmp instead of /dev/shm because /dev/shm has only 2627813376 bytes available. This will harm performance! You may be able to free up space by deleting files in /dev/shm. If you are inside a Docker container, you can increase /dev/shm size by passing '--shm-size=10.24gb' to 'docker run' (or add it to the run_options list in a Ray cluster config). Make sure to set this to more than 30% of available RAM.
[36m(ClientAppActor pid=365596)[0m /usr/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=365596) is multi-threaded, use of fork() may lead to deadlocks in the child.
[36m(ClientAppActor pid=365596)[0m   self.pid = os.fork()
[36m(ClientAppActor pid=365595)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.pin_memory() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:46.)
[36m(ClientAppActor pid=365595)[0m   return data.pin_memory(device)
[36m(ClientAppActor pid=365595)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.is_pinned() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:31.)
[36m(ClientAppActor pid=365595)[0m   return data.pin_memory(device)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.5640898456398808}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.5885
[92mINFO [0m:          eval_loss   : 0.7056
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.6028
[92mINFO [0m:          eval_loss   : 0.6703
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.6040
[92mINFO [0m:          eval_loss   : 0.6938
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.6041
[92mINFO [0m:        sensitivity : 0.0000
[92mINFO [0m:        specificity : 1.0000
[92mINFO [0m:        precision   : 0.0000
[92mINFO [0m:        f1          : 0.0000
[92mINFO [0m:      âœ“ New best model! Round 1, AUROC: 0.6041
[92mINFO [0m:        Model saved to models/job1014_rollv1_round1_auroc6040.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.6040681006776587, 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'f1': 0.0}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.20762026291330918}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.6154
[92mINFO [0m:          eval_loss   : 0.7136
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.6328
[92mINFO [0m:          eval_loss   : 0.6659
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.6324
[92mINFO [0m:          eval_loss   : 0.6976
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.6348
[92mINFO [0m:        sensitivity : 0.0000
[92mINFO [0m:        specificity : 1.0000
[92mINFO [0m:        precision   : 0.0000
[92mINFO [0m:        f1          : 0.0000
[92mINFO [0m:      âœ“ New best model! Round 2, AUROC: 0.6348
[92mINFO [0m:        Model saved to models/job1014_rollv1_round2_auroc6348.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.6348072554212707, 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'f1': 0.0}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.2044799760785131}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7530
[92mINFO [0m:          eval_loss   : 0.7891
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.3787
[92mINFO [0m:          f1          : 0.5493
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7034
[92mINFO [0m:          eval_loss   : 0.7159
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.5183
[92mINFO [0m:          f1          : 0.6828
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7294
[92mINFO [0m:          eval_loss   : 0.7411
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.4709
[92mINFO [0m:          f1          : 0.6402
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7330
[92mINFO [0m:        sensitivity : 1.0000
[92mINFO [0m:        specificity : 0.0000
[92mINFO [0m:        precision   : 0.4588
[92mINFO [0m:        f1          : 0.6290
[92mINFO [0m:      âœ“ New best model! Round 3, AUROC: 0.7330
[92mINFO [0m:        Model saved to models/job1014_rollv1_round3_auroc7330.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.733023325224157, 'sensitivity': 1.0, 'specificity': 0.0, 'precision': 0.4587545126353791, 'f1': 0.6289673946668316}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.20748703914069166}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7544
[92mINFO [0m:          eval_loss   : 0.7715
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.3787
[92mINFO [0m:          f1          : 0.5493
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7071
[92mINFO [0m:          eval_loss   : 0.7056
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.5183
[92mINFO [0m:          f1          : 0.6828
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7384
[92mINFO [0m:          eval_loss   : 0.7317
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.4709
[92mINFO [0m:          f1          : 0.6402
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7386
[92mINFO [0m:        sensitivity : 1.0000
[92mINFO [0m:        specificity : 0.0000
[92mINFO [0m:        precision   : 0.4588
[92mINFO [0m:        f1          : 0.6290
[92mINFO [0m:      âœ“ New best model! Round 4, AUROC: 0.7386
[92mINFO [0m:        Model saved to models/job1014_rollv1_round4_auroc7386.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7386114855578488, 'sensitivity': 1.0, 'specificity': 0.0, 'precision': 0.4587545126353791, 'f1': 0.6289673946668316}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[36m(ClientAppActor pid=365595)[0m Traceback (most recent call last):
[36m(ClientAppActor pid=365595)[0m   File "/usr/lib/python3.12/multiprocessing/queues.py", line 264, in _feed
[36m(ClientAppActor pid=365595)[0m     obj = _ForkingPickler.dumps(obj)
[36m(ClientAppActor pid=365595)[0m           ^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(ClientAppActor pid=365595)[0m   File "/usr/lib/python3.12/multiprocessing/reduction.py", line 51, in dumps
[36m(ClientAppActor pid=365595)[0m     cls(buf, protocol).dump(obj)
[36m(ClientAppActor pid=365595)[0m   File "/scratch/hackathon-venv/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 618, in reduce_storage
[36m(ClientAppActor pid=365595)[0m     fd, size = storage._share_fd_cpu_()
[36m(ClientAppActor pid=365595)[0m                ^^^^^^^^^^^^^^^^^^^^^^^^
[36m(ClientAppActor pid=365595)[0m   File "/scratch/hackathon-venv/lib/python3.12/site-packages/torch/storage.py", line 451, in wrapper
[36m(ClientAppActor pid=365595)[0m     return fn(self, *args, **kwargs)
[36m(ClientAppActor pid=365595)[0m            ^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(ClientAppActor pid=365595)[0m   File "/scratch/hackathon-venv/lib/python3.12/site-packages/torch/storage.py", line 526, in _share_fd_cpu_
[36m(ClientAppActor pid=365595)[0m     return super()._share_fd_cpu_(*args, **kwargs)
[36m(ClientAppActor pid=365595)[0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(ClientAppActor pid=365595)[0m RuntimeError: unable to allocate shared memory(shm) for file </torch_425536_1611393519_229>: Resource temporarily unavailable (11)
[36m(ClientAppActor pid=365595)[0m Traceback (most recent call last):
[36m(ClientAppActor pid=365595)[0m   File "/usr/lib/python3.12/multiprocessing/queues.py", line 264, in _feed
[36m(ClientAppActor pid=365595)[0m     obj = _ForkingPickler.dumps(obj)
[36m(ClientAppActor pid=365595)[0m           ^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(ClientAppActor pid=365595)[0m   File "/usr/lib/python3.12/multiprocessing/reduction.py", line 51, in dumps
[36m(ClientAppActor pid=365595)[0m     cls(buf, protocol).dump(obj)
[36m(ClientAppActor pid=365595)[0m   File "/scratch/hackathon-venv/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 618, in reduce_storage
[36m(ClientAppActor pid=365595)[0m     fd, size = storage._share_fd_cpu_()
[36m(ClientAppActor pid=365595)[0m                ^^^^^^^^^^^^^^^^^^^^^^^^
[36m(ClientAppActor pid=365595)[0m   File "/scratch/hackathon-venv/lib/python3.12/site-packages/torch/storage.py", line 451, in wrapper
[36m(ClientAppActor pid=365595)[0m     return fn(self, *args, **kwargs)
[36m(ClientAppActor pid=365595)[0m            ^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(ClientAppActor pid=365595)[0m   File "/scratch/hackathon-venv/lib/python3.12/site-packages/torch/storage.py", line 526, in _share_fd_cpu_
[36m(ClientAppActor pid=365595)[0m     return super()._share_fd_cpu_(*args, **kwargs)
[36m(ClientAppActor pid=365595)[0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(ClientAppActor pid=365595)[0m RuntimeError: unable to allocate shared memory(shm) for file </torch_425524_1383959277_234>: Resource temporarily unavailable (11)
[36m(ClientAppActor pid=365594)[0m /usr/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=365594) is multi-threaded, use of fork() may lead to deadlocks in the child.[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=365594)[0m   self.pid = os.fork()[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=365594)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.pin_memory() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:46.)[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=365594)[0m   return data.pin_memory(device)[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=365594)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.is_pinned() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:31.)[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=365596)[0m RuntimeError: unable to allocate shared memory(shm) for file </torch_425538_3996511826_228>: Success (0)
[2025-11-15T08:15:43] error: *** JOB 1014 ON gpu-workers-0 CANCELLED AT 2025-11-15T08:15:43 DUE to SIGNAL Terminated ***
=== Copying best model ===
  job1014_rollv1_round4_auroc7386.pt
=== Job 1014 finished with exit code 0 ===
