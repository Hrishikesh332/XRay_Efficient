=== Job 433 started at Fri Nov 14 20:46:23 UTC 2025 on gpu-workers-1 ===
=== Running: flwr run . cluster-gpu ===
Loading project configuration... 
Success
[92mINFO [0m:      Device: AMD Instinct MI300X VF
[92mINFO [0m:      W&B disabled (credentials not provided). Set WANDB_API_KEY, WANDB_ENTITY, and WANDB_PROJECT to enable.
Downloading: "https://download.pytorch.org/models/efficientnet_b0_rwightman-7f5810bc.pth" to /tmp/job-433/xdg-cache/torch/hub/checkpoints/efficientnet_b0_rwightman-7f5810bc.pth
  0%|          | 0.00/20.5M [00:00<?, ?B/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 20.5M/20.5M [00:00<00:00, 482MB/s]
[92mINFO [0m:      Starting HackathonFedAvg strategy:
[92mINFO [0m:      	â”œâ”€â”€ Number of rounds: 100
[92mINFO [0m:      	â”œâ”€â”€ ArrayRecord (15.49 MB)
[92mINFO [0m:      	â”œâ”€â”€ ConfigRecord (train): {'lr': 0.05}
[92mINFO [0m:      	â”œâ”€â”€ ConfigRecord (evaluate): (empty!)
[92mINFO [0m:      	â”œâ”€â”€> Sampling:
[92mINFO [0m:      	â”‚	â”œâ”€â”€Fraction: train (1.00) | evaluate ( 1.00)
[92mINFO [0m:      	â”‚	â”œâ”€â”€Minimum nodes: train (2) | evaluate (2)
[92mINFO [0m:      	â”‚	â””â”€â”€Minimum available nodes: 2
[92mINFO [0m:      	â””â”€â”€> Keys in records:
[92mINFO [0m:      		â”œâ”€â”€ Weighted by: 'num-examples'
[92mINFO [0m:      		â”œâ”€â”€ ArrayRecord key: 'arrays'
[92mINFO [0m:      		â””â”€â”€ ConfigRecord key: 'config'
[92mINFO [0m:      
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[36m(ClientAppActor pid=648735)[0m /usr/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=648735) is multi-threaded, use of fork() may lead to deadlocks in the child.
[36m(ClientAppActor pid=648735)[0m   self.pid = os.fork()
[36m(ClientAppActor pid=648737)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.pin_memory() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:46.)
[36m(ClientAppActor pid=648737)[0m   return data.pin_memory(device)
[36m(ClientAppActor pid=648737)[0m /scratch/hackathon-venv/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py:57: DeprecationWarning: The argument 'device' of Tensor.is_pinned() is deprecated. Please do not pass this argument. (Triggered internally at /pytorch/aten/src/ATen/native/Memory.cpp:31.)
[36m(ClientAppActor pid=648737)[0m   return data.pin_memory(device)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 1.7183951184423067}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.6581
[92mINFO [0m:          eval_loss   : 0.8216
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.6908
[92mINFO [0m:          eval_loss   : 0.6873
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.6793
[92mINFO [0m:          eval_loss   : 0.7767
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.6827
[92mINFO [0m:        sensitivity : 0.0000
[92mINFO [0m:        specificity : 1.0000
[92mINFO [0m:        precision   : 0.0000
[92mINFO [0m:        f1          : 0.0000
[92mINFO [0m:      âœ“ New best model! Round 1, AUROC: 0.6827
[92mINFO [0m:        Model saved to models/job433_204622_round1_auroc6826.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.6826885145635313, 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'f1': 0.0}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.8206408620805958}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7058
[92mINFO [0m:          eval_loss   : 0.6960
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.5183
[92mINFO [0m:          f1          : 0.6828
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7529
[92mINFO [0m:          eval_loss   : 0.7494
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.3787
[92mINFO [0m:          f1          : 0.5493
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7348
[92mINFO [0m:          eval_loss   : 0.7153
[92mINFO [0m:          sensitivity : 1.0000
[92mINFO [0m:          specificity : 0.0000
[92mINFO [0m:          precision   : 0.4709
[92mINFO [0m:          f1          : 0.6402
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7365
[92mINFO [0m:        sensitivity : 1.0000
[92mINFO [0m:        specificity : 0.0000
[92mINFO [0m:        precision   : 0.4588
[92mINFO [0m:        f1          : 0.6290
[92mINFO [0m:      âœ“ New best model! Round 2, AUROC: 0.7365
[92mINFO [0m:        Model saved to models/job433_204622_round2_auroc7365.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7365250760995948, 'sensitivity': 1.0, 'specificity': 0.0, 'precision': 0.4587545126353791, 'f1': 0.6289673946668316}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.7656287025435412}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7179
[92mINFO [0m:          eval_loss   : 0.6586
[92mINFO [0m:          sensitivity : 0.3965
[92mINFO [0m:          specificity : 0.8494
[92mINFO [0m:          precision   : 0.7391
[92mINFO [0m:          f1          : 0.5161
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7662
[92mINFO [0m:          eval_loss   : 0.5904
[92mINFO [0m:          sensitivity : 0.2789
[92mINFO [0m:          specificity : 0.9505
[92mINFO [0m:          precision   : 0.7744
[92mINFO [0m:          f1          : 0.4100
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7453
[92mINFO [0m:          eval_loss   : 0.6272
[92mINFO [0m:          sensitivity : 0.4456
[92mINFO [0m:          specificity : 0.8637
[92mINFO [0m:          precision   : 0.7442
[92mINFO [0m:          f1          : 0.5575
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7477
[92mINFO [0m:        sensitivity : 0.3964
[92mINFO [0m:        specificity : 0.8863
[92mINFO [0m:        precision   : 0.7471
[92mINFO [0m:        f1          : 0.5180
[92mINFO [0m:      âœ“ New best model! Round 3, AUROC: 0.7477
[92mINFO [0m:        Model saved to models/job433_204622_round3_auroc7476.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7476905053615405, 'sensitivity': 0.39641943734015345, 'specificity': 0.8862764715691179, 'precision': 0.7471264367816092, 'f1': 0.5179948586118253}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.6710329436780025}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7220
[92mINFO [0m:          eval_loss   : 0.6479
[92mINFO [0m:          sensitivity : 0.8686
[92mINFO [0m:          specificity : 0.3817
[92mINFO [0m:          precision   : 0.6019
[92mINFO [0m:          f1          : 0.7110
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7741
[92mINFO [0m:          eval_loss   : 0.6434
[92mINFO [0m:          sensitivity : 0.8227
[92mINFO [0m:          specificity : 0.5537
[92mINFO [0m:          precision   : 0.5291
[92mINFO [0m:          f1          : 0.6440
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7515
[92mINFO [0m:          eval_loss   : 0.6609
[92mINFO [0m:          sensitivity : 0.9002
[92mINFO [0m:          specificity : 0.3756
[92mINFO [0m:          precision   : 0.5619
[92mINFO [0m:          f1          : 0.6919
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7535
[92mINFO [0m:        sensitivity : 0.8749
[92mINFO [0m:        specificity : 0.4297
[92mINFO [0m:        precision   : 0.5653
[92mINFO [0m:        f1          : 0.6868
[92mINFO [0m:      âœ“ New best model! Round 4, AUROC: 0.7535
[92mINFO [0m:        Model saved to models/job433_204622_round4_auroc7535.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.75351069855867, 'sensitivity': 0.8748770411174503, 'specificity': 0.42971485742871435, 'precision': 0.565272657938223, 'f1': 0.6867953667953669}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.6136944206994555}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7802
[92mINFO [0m:          eval_loss   : 0.5578
[92mINFO [0m:          sensitivity : 0.5282
[92mINFO [0m:          specificity : 0.8678
[92mINFO [0m:          precision   : 0.7088
[92mINFO [0m:          f1          : 0.6053
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7263
[92mINFO [0m:          eval_loss   : 0.6151
[92mINFO [0m:          sensitivity : 0.6297
[92mINFO [0m:          specificity : 0.7110
[92mINFO [0m:          precision   : 0.7010
[92mINFO [0m:          f1          : 0.6634
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7515
[92mINFO [0m:          eval_loss   : 0.5958
[92mINFO [0m:          sensitivity : 0.6901
[92mINFO [0m:          specificity : 0.7177
[92mINFO [0m:          precision   : 0.6851
[92mINFO [0m:          f1          : 0.6876
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7563
[92mINFO [0m:        sensitivity : 0.6388
[92mINFO [0m:        specificity : 0.7607
[92mINFO [0m:        precision   : 0.6935
[92mINFO [0m:        f1          : 0.6650
[92mINFO [0m:      âœ“ New best model! Round 5, AUROC: 0.7563
[92mINFO [0m:        Model saved to models/job433_204622_round5_auroc7562.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.75625807198307, 'sensitivity': 0.6387959866220736, 'specificity': 0.7607136901784225, 'precision': 0.6935070482699701, 'f1': 0.6650281618023554}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.8933729834344936}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7256
[92mINFO [0m:          eval_loss   : 0.6408
[92mINFO [0m:          sensitivity : 0.8148
[92mINFO [0m:          specificity : 0.4844
[92mINFO [0m:          precision   : 0.6297
[92mINFO [0m:          f1          : 0.7104
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7806
[92mINFO [0m:          eval_loss   : 0.6141
[92mINFO [0m:          sensitivity : 0.7535
[92mINFO [0m:          specificity : 0.6601
[92mINFO [0m:          precision   : 0.5746
[92mINFO [0m:          f1          : 0.6520
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7534
[92mINFO [0m:          eval_loss   : 0.6486
[92mINFO [0m:          sensitivity : 0.8561
[92mINFO [0m:          specificity : 0.4830
[92mINFO [0m:          precision   : 0.5957
[92mINFO [0m:          f1          : 0.7025
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7571
[92mINFO [0m:        sensitivity : 0.8227
[92mINFO [0m:        specificity : 0.5358
[92mINFO [0m:        precision   : 0.6003
[92mINFO [0m:        f1          : 0.6942
[92mINFO [0m:      âœ“ New best model! Round 6, AUROC: 0.7571
[92mINFO [0m:        Model saved to models/job433_204622_round6_auroc7571.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7571469681328957, 'sensitivity': 0.822742474916388, 'specificity': 0.535767883941971, 'precision': 0.6003445305770887, 'f1': 0.694165490912109}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.5861795864841796}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7290
[92mINFO [0m:          eval_loss   : 0.8758
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7779
[92mINFO [0m:          eval_loss   : 0.7062
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7539
[92mINFO [0m:          eval_loss   : 0.7832
[92mINFO [0m:          sensitivity : 0.0000
[92mINFO [0m:          specificity : 1.0000
[92mINFO [0m:          precision   : 0.0000
[92mINFO [0m:          f1          : 0.0000
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7578
[92mINFO [0m:        sensitivity : 0.0000
[92mINFO [0m:        specificity : 1.0000
[92mINFO [0m:        precision   : 0.0000
[92mINFO [0m:        f1          : 0.0000
[92mINFO [0m:      âœ“ New best model! Round 7, AUROC: 0.7578
[92mINFO [0m:        Model saved to models/job433_204622_round7_auroc7578.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7578477086926964, 'sensitivity': 0.0, 'specificity': 1.0, 'precision': 0.0, 'f1': 0.0}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[92mINFO [0m:      aggregate_train: Received 3 results and 0 failures
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'partition-id': 0.7453931785883467, 'train_loss': 0.6711797923248549}
[92mINFO [0m:      configure_evaluate: Sampled 3 nodes (out of 3)
[92mINFO [0m:      METRICS BY HOSPITAL
[92mINFO [0m:        HospitalC (n=2730):
[92mINFO [0m:          auroc       : 0.7330
[92mINFO [0m:          eval_loss   : 0.6087
[92mINFO [0m:          sensitivity : 0.7371
[92mINFO [0m:          specificity : 0.6289
[92mINFO [0m:          precision   : 0.6813
[92mINFO [0m:          f1          : 0.7081
[92mINFO [0m:        HospitalB (n=2860):
[92mINFO [0m:          auroc       : 0.7806
[92mINFO [0m:          eval_loss   : 0.5650
[92mINFO [0m:          sensitivity : 0.6417
[92mINFO [0m:          specificity : 0.7777
[92mINFO [0m:          precision   : 0.6376
[92mINFO [0m:          f1          : 0.6397
[92mINFO [0m:        HospitalA (n=5490):
[92mINFO [0m:          auroc       : 0.7558
[92mINFO [0m:          eval_loss   : 0.6027
[92mINFO [0m:          sensitivity : 0.7679
[92mINFO [0m:          specificity : 0.6224
[92mINFO [0m:          precision   : 0.6441
[92mINFO [0m:          f1          : 0.7005
[92mINFO [0m:      AGGREGATED METRICS:
[92mINFO [0m:        auroc       : 0.7604
[92mINFO [0m:        sensitivity : 0.7324
[92mINFO [0m:        specificity : 0.6698
[92mINFO [0m:        precision   : 0.6528
[92mINFO [0m:        f1          : 0.6903
[92mINFO [0m:      âœ“ New best model! Round 8, AUROC: 0.7604
[92mINFO [0m:        Model saved to models/job433_204622_round8_auroc7604.pt
[92mINFO [0m:      	â””â”€â”€> Aggregated MetricRecord: {'auroc': 0.7604236901059225, 'sensitivity': 0.7324414715719063, 'specificity': 0.6698349174587294, 'precision': 0.6528143082588111, 'f1': 0.6903393287595031}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 9/100]
[92mINFO [0m:      configure_train: Sampled 3 nodes (out of 3)
[2025-11-14T21:06:40] error: *** JOB 433 ON gpu-workers-1 CANCELLED AT 2025-11-14T21:06:40 DUE TO TIME LIMIT ***
=== Copying best model ===
  job433_204622_round8_auroc7604.pt
=== Job 433 finished with exit code 0 ===
